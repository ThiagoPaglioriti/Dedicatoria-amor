<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dedicatoria</title>
<link rel="stylesheet" href="styles.css">
<style>
.click-message{
	position:fixed;
	/* top/left se ajustan din√°micamente desde JS */
	top: auto;
	left: 50%;
	transform: translateX(-50%) translateY(10px);
	background: rgba(0,0,0,0.85);
	color: #fff;
	padding: 10px 14px;
	border-radius: 8px;
	font-size: 1rem;
	z-index: 1200;
	opacity: 0;
	transition: opacity .18s ease, transform .18s ease, left .08s linear, top .08s linear;
	pointer-events: none;
}
.click-message.visible{ opacity:1; transform:translateX(-50%) translateY(0); pointer-events:auto; }
</style>
</head>
<body class="page page-love" onclick="mostrarTexto(event)" role="application" tabindex="0">
<header class="love-header">
<h1>Desde aquel d√≠a...</h1>
</header>

<section class="gallery-section center">
<h2>Nuestros Recuerdos</h2>
<div class="carousel" id="carousel">
<!-- im√°genes de ejemplo (puedes reemplazarlas por las tuyas) -->
<img src="https://picsum.photos/seed/1/400/600" alt="foto1"/>
<img src="https://picsum.photos/seed/2/400/600" alt="foto2"/>
<img src="https://picsum.photos/seed/3/400/600" alt="foto3"/>
<img src="https://picsum.photos/seed/4/400/600" alt="foto4"/>
<img src="https://picsum.photos/seed/5/400/600" alt="foto5"/>
</div>
<small class="drag-hint">Mant√©n el click y arrastra para mover las fotos</small>
</section>

<section class="time-section center">
<h2>Nuestro Tiempo Juntos</h2>
<div class="avatar-and-counter">
<div class="avatar">
<img src="https://picsum.photos/seed/couple/300/300" alt="pareja"/>
</div>

<div class="counter-card" id="counterCard">
<div class="row">
<div class="cell"><div class="num" id="years">0</div><div class="label">A√ëOS</div></div>
<div class="cell"><div class="num" id="months">3</div><div class="label">MESES</div></div>
<div class="cell"><div class="num" id="days">106</div><div class="label">D√çAS</div></div>
</div>
<div class="row">
<div class="cell"><div class="num" id="hours">21</div><div class="label">HORAS</div></div>
<div class="cell"><div class="num" id="minutes">12</div><div class="label">MINUTOS</div></div>
<div class="cell"><div class="num" id="seconds">47</div><div class="label">SEGUNDOS</div></div>
</div>
</div>
</div>
</section>

<section class="letter-section center">
	<h2>Carta de Mi Coraz√≥n</h2>

	<!-- SOBRE: cuando se hace click en el sello se abre la carta -->
	<div id="sobre" class="sobre">
		<!-- Solapa superior (flap) que se animar√° al abrir -->
		<div class="flap" aria-hidden="true"></div>
		<!-- Sello centrado con forma de coraz√≥n; role/button y tabindex para accesibilidad -->
		<div class="sello" onclick="abrirCarta()" role="button" aria-label="Abrir carta" tabindex="0">‚ù§</div>
	</div>

	<p class="back-link center"><a href="candado.html">Volver</a></p>

	<!-- CARTA: panel que aparece al abrir el sobre. Contiene el mismo texto que la carta original. -->
	<div id="carta" class="carta" aria-hidden="true">
		<!-- Bot√≥n de cierre con explicaci√≥n en comentario -->
		<button class="cerrar" onclick="cerrarCarta()" aria-label="Cerrar carta">‚úñ</button>
		<!-- decoraciones (corazones en las esquinas) -->
		<div class="decor-icons" aria-hidden="true">
			<span class="heart tl">‚ù§</span>
			<span class="heart tr">‚ù§</span>
			<span class="heart bl">‚ù§</span>
			<span class="heart br">‚ù§</span>
		</div>

		<!-- t√≠tulo personalizado -->
		<h3 class="letter-title">Mi Amor:</h3>

		<div class="letter-content">
			<p class="letter-text">Mi amor, desde el primer d√≠a que te vi, supe que ibas a ser mi princesa. Cada risa, cada l√°grima, cada abrazo con vos fue un tesoro que guardo en mi coraz√≥n. Sos mi sol en d√≠as grises, mi refugio en las tormentas y mi alegr√≠a en cada momento. No hay palabras suficientes para expresar cu√°nto te amo, pero prometo pasar cada d√≠a demostr√°ndotelo con hechos, con cari√±o, con todo lo que soy. Gracias por ser mi todo, hoy y siempre.</p>
		</div>

		<!-- arte en la esquina inferior derecha: coraz√≥n + rosa -->
		<div class="art" aria-hidden="true">
			<div class="rose">üåπ</div>
			<div class="big-heart">‚ù§</div>
		</div>
	</div>

</section>

<script>
// ---- Carousel: drag to scroll ----
const carousel = document.getElementById('carousel');
let isDown = false, startX, scrollLeft;
carousel.addEventListener('mousedown', (e)=>{
isDown = true; carousel.classList.add('dragging'); startX = e.pageX - carousel.offsetLeft; scrollLeft = carousel.scrollLeft;
});
window.addEventListener('mouseup', ()=>{ isDown = false; carousel.classList.remove('dragging'); });
carousel.addEventListener('mouseleave', ()=>{ isDown = false; carousel.classList.remove('dragging'); });
carousel.addEventListener('mousemove', (e)=>{
if(!isDown) return;
e.preventDefault();
const x = e.pageX - carousel.offsetLeft;
const walk = (x - startX) * 1.5; //scroll-fast
carousel.scrollLeft = scrollLeft - walk;
});
// ---- Countdown (desde 2025-06-30 20:42 local) ----
const startDate = new Date(2025, 5, 30, 20, 42, 0); // mes 5 = junio (0-based)
const yEl = document.getElementById('years');
const moEl = document.getElementById('months');
const dEl = document.getElementById('days');
const hEl = document.getElementById('hours');
const miEl = document.getElementById('minutes');
const sEl = document.getElementById('seconds');


function updateCountdown(){
const now = new Date();}
if(now < startDate){
yEl.textContent=moEl.textContent=dEl.textContent=hEl.textContent=miEl.textContent=sEl.textContent='0';
return;
}
// calc difference component-wise
let ys = now.getFullYear() - startDate.getFullYear();
let ms = now.getMonth() - startDate.getMonth();
let ds = now.getDate() - startDate.getDate();
let hs = now.getHours() - startDate.getHours();
let mis = now.getMinutes() - startDate.getMinutes();
let ss = now.getSeconds() - startDate.getSeconds();


if(ss < 0){ ss += 60; mis -= 1; }
if(mis < 0){ mis += 60; hs -= 1; }
if(hs < 0){ hs += 24; ds -= 1; }
if(ds < 0){
// borrow days from previous month
const prev = new Date(now.getFullYear(), now.getMonth(), 0); // last day of previous month
ds += prev.getDate();
ms -= 1;
}
if(ms < 0){ ms += 12; ys -= 1; }

{
yEl.textContent = ys;
moEl.textContent = ms;
dEl.textContent = ds;
hEl.textContent = hs;
miEl.textContent = mis;
sEl.textContent = ss;
}
setInterval(updateCountdown, 250);
updateCountdown();
</script>

<!-- Listener de teclado para el sello: abre carta con Enter o Space -->
<script>
	(function(){
		const sello = document.querySelector('.sello');
		if(!sello) return;
		sello.addEventListener('keydown', (e)=>{
			if(e.code === 'Enter' || e.code === 'Space' || e.key === ' '){
				e.preventDefault();
				abrirCarta();
			}
		});
	})();
</script>

<!-- Script para controlar el sobre y la carta (abre/cierra) -->
<script>
	/**
	 * abrirCarta()
	 * - Oculta el sobre y muestra la carta.
	 * - Ajusta aria-hidden para que lectores de pantalla sepan el estado.
	 */
	function abrirCarta(){
		const sobre = document.getElementById('sobre');
		const carta = document.getElementById('carta');
		if(!sobre || !carta) return;
			// A√±adir clase que activa la animaci√≥n de la solapa
			sobre.classList.add('opening');
			// Esperar a la animaci√≥n (un poco m√°s que la transici√≥n CSS de 450ms) antes de mostrar la carta
			setTimeout(()=>{
				sobre.style.display = 'none';
				carta.style.display = 'block';
				carta.setAttribute('aria-hidden','false');
				// limpiar la clase para permitir re-animaciones futuras
				sobre.classList.remove('opening');
			}, 520);
	}

	/**
	 * cerrarCarta()
	 * - Oculta la carta y vuelve a mostrar el sobre.
	 */
	function cerrarCarta(){
		const sobre = document.getElementById('sobre');
		const carta = document.getElementById('carta');
		if(!sobre || !carta) return;
			// Ocultamos la carta y devolvemos el sobre. Podemos a√±adir una peque√±a animaci√≥n inversa si queremos.
			carta.style.display = 'none';
			carta.setAttribute('aria-hidden','true');
			sobre.style.display = 'inline-block';
	}
</script>
<!-- Mensaje al hacer click en la p√°gina -->
<p id="mensaje" class="click-message" role="status" aria-live="polite" aria-atomic="true">¬°Hiciste clic en la p√°gina! üëè</p>
<script>
	(function(){
		const msg = document.getElementById('mensaje');
		let hideTimeout = null;

				// list of affectionate messages (se pueden personalizar v√≠a data-messages)
				const defaultMessages = [
					'Siempre ser√°s mi reina üëë',
					'Eres mi todo üíñ',
					'Contigo, todo tiene sentido ‚ú®',
					'Te amo hoy y siempre üíò',
                    'Eres mi raz√≥n de sonre√≠r üòä',
                    'Cada d√≠a contigo es un regalo üéÅ',
                    '¬øPara cu√°ndo unos clashitos? xd',
				];

				// show message and auto-hide ‚Äî accepts an Event (mouse/touch) or no arg (keyboard)
				window.mostrarTexto = function(ev){
				if(!msg) return;

				// if invoked from a click, avoid showing when clicking interactive elements
				if(ev && ev.target && ev.target.closest && ev.target.closest('a, button, input, textarea, select, label')) return;

				// determine coordinates: mouse/touch -> clientX/clientY; keyboard -> center
				let x = window.innerWidth / 2;
				let y = window.innerHeight / 2;
				if(ev && typeof ev.clientX === 'number'){
					x = ev.clientX;
					y = ev.clientY;
				} else if(ev && ev.touches && ev.touches[0]){
					x = ev.touches[0].clientX;
					y = ev.touches[0].clientY;
				}

						// set message text: prefer data-messages attribute (JSON/CSV) otherwise random default
						let messages = defaultMessages;
						try{
							const attr = msg.getAttribute('data-messages');
							if(attr){
								// try JSON array first
								if(attr.trim().startsWith('[')) messages = JSON.parse(attr);
								else messages = attr.split('|').map(s=>s.trim()).filter(Boolean);
							}
						}catch(e){ /* ignore parse errors and fallback */ }
						const chosen = messages[Math.floor(Math.random()*messages.length)];
						msg.textContent = chosen;

						// prepare message for measurement
				msg.classList.remove('visible');
				msg.style.left = '0px';
				msg.style.top = '0px';

				// Small delay to ensure offsets are correct (usually not needed but safe)
				const place = ()=>{
					const mw = msg.offsetWidth || 120;
					const mh = msg.offsetHeight || 32;

					// We position the message above the click (so pointer isn't obscured)
					const padding = 8; // viewport padding

					// left is the horizontal center point (we use translateX(-50%) in CSS)
					const minCenterX = padding + mw / 2;
					const maxCenterX = window.innerWidth - padding - mw / 2;
					const centerX = Math.max(minCenterX, Math.min(maxCenterX, x));

					// desired top (above cursor)
					let desiredTop = y - mh - 12; // 12px gap above cursor
					// if not enough space above, place below the cursor
					if(desiredTop < padding) desiredTop = y + 12;
					// clamp vertically
					const maxTop = window.innerHeight - mh - padding;
					desiredTop = Math.max(padding, Math.min(maxTop, desiredTop));

					msg.style.left = centerX + 'px';
					msg.style.top = desiredTop + 'px';

					// show and auto-hide
					msg.classList.add('visible');
					clearTimeout(hideTimeout);
					hideTimeout = setTimeout(()=> msg.classList.remove('visible'), 2500);
				};

				// If element wasn't rendered/measured yet, use requestAnimationFrame
				if(msg.offsetWidth === 0){
					requestAnimationFrame(place);
				} else {
					place();
				}
			};

			// support keyboard activation: Enter or Space on the document body
			window.addEventListener('keydown', (e)=>{
				if(e.code === 'Enter' || e.code === 'Space' || e.key === ' '){
					const active = document.activeElement;
					if(active && (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA' || active.isContentEditable)) return;
					// call mostrarTexto without event: it will place the message at center
					mostrarTexto();
				}
			});

			// also close on click of the message (optional) so keyboard users can dismiss
			msg.addEventListener('click', ()=>{ msg.classList.remove('visible'); clearTimeout(hideTimeout); });
	})();
</script>
</body>
</html>